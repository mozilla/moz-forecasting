version: 2.1

setup: true

orbs:
  continuation: circleci/continuation@1.0.0

parameters:
  deploy:
    type: boolean
    default: false

workflows:
  pr_checks:
    when:
      and:
        - not:
            equal: [main, << pipeline.git.branch >>]
    jobs:
      - continuation/continue:
          configuration_path: .circleci/workflows.yml
  setup-main:
    when:
      equal: [get_outerbound_working, << pipeline.git.branch >>]
    jobs:
      - continuation/continue:
          configuration_path: .circleci/workflows.yml
          parameters: '{"deploy": true}'